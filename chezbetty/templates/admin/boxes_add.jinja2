{% extends "base.jinja2" %}
{% set active_page = 'boxes_add' %}
{% block title %}Add New Boxes{% endblock %}

{% block top %}
<h1 class="page-header">Add New Box</h1>
{% endblock %}

{% block content %}

<form role="form" id="box_add_form" action="/admin/box/add/submit" method="post">

<h2>Box Name and Barcode</h2>

<table id="new-box-table" class="table">
  <tbody>
    <tr>
      <td class="box-category-text">Box Name</td>
      <td class="box-example-text">(Autogenerated)</td>
      <td><input type="text" class="form-control box-name-text" id="box-name" name="box-name" value="{{ d['box-name'] }}"></td>
    </tr>
    <tr>
      <td>General Name</td>
      <td class="box-example-text">(Ex: Vitamin Water)</td>
      <td><input type="text" class="form-control" id="box-general-name" name="box-general-name" value="{{ d['box-general-name'] }}"></td>
    </tr>
    <tr>
      <td>Flavors/Types</td>
      <td class="box-example-text">(Ex: Revive, Dragonfruit, XXX)</td>
      <td><input type="text" class="form-control" id="box-variants" name="box-variants" value="{{ d['box-variants'] }}"></td>
    </tr>
    <tr>
      <td>Volume</td>
      <td class="box-example-text">(Ex: 20oz)</td>
      <td><input type="text" class="form-control" id="box-volume" name="box-volume" value="{{ d['box-volume'] }}"></td>
    </tr>
    <tr>
      <td>Subitem Quantity</td>
      <td class="box-example-text">(Ex: 20)</td>
      <td><input type="number" min="0" class="form-control" id="box-quantity" name="box-quantity" value="{{ d['box-quantity'] }}"></td>
    </tr>
    <tr>
      <td>Barcode</td>
      <td></td>
      <td><input type="number" min="0" class="form-control barcode-check" id="box-barcode" name="box-barcode" value="{{ d['box-barcode'] }}"></td>
    </tr>
    <tr>
      <td>Sales Tax</td>
      <td></td>
      <td>
        <input type="hidden" name="box-sales_tax" value="off">
        <input type="checkbox" class="form-control" id="box-sales_tax" name="box-sales_tax" {% if d['box-sales_tax'] == "on" %}checked="checked"{% endif %}>
      </td>
    </tr>
    <tr>
      <td>Bottle Deposit</td>
      <td></td>
      <td>
        <input type="hidden" name="box-bottle_dep" value="off">
        <input type="checkbox" class="form-control" id="box-bottle_dep" name="box-bottle_dep" {% if d['box-bottle_dep'] == "on" %}checked="checked"{% endif %}>
      </td>
    </tr>
    <tr>
      <td>Vendor Number</td>
      <td>{{ forms.dropdown("box-vendor", vendors, d['box-vendor']|default("0")) }}</td>
      <td><input type="number" min="0" class="form-control" id="box-vendor-item_num" name="box-vendor-item_num" value="{{ d['box-vendor-item_num'] }}"></td>
    </tr>
  </tbody>
</table>

<h2>Sub Items</h2>

<input type="hidden" id="box-subitem-count" name="box-subitem-count" value="{{ d['subitem_count'] }}">

<table class="table box-subitem">
  <thead>
    <tr>
      <th>Item</th>
      <th style="width:15%;">Quantity</th>
    </tr>
  </thead>
  <tbody id="box-subitem-rows">
    {% for i in range(0, d['subitem_count']|int) %}
    <tr id="box-item-{{ i }}">
      <td>
        <select class="form-control box-subitem-select" id="box-item-{{ i }}-item" name="box-item-{{ i }}-item">
          <option value="">-</option>
          <option value="new" {% if d['box-item-'~i~'-item'] == "new" %}selected="selected"{% endif %}>Add New Item</option>
          {% for item in items %}
          <option value="{{ item.id }}" {% if d['box-item-'~i~'-item']|default("0")|int == item.id %}selected="selected"{% endif %}>{{ item.name }} (Barcode: {{ item.barcode }})</option>
          {% endfor %}
        </select>

        <table class="table new-box-item-table" id="box-item-{{ i }}-new" {% if d['box-item-'~i~'-item'] != "new" %}style="display:none;"{% endif %}>
          <tbody>
            <tr>
              <td class="box-category-text">Item Name</td>
              <td class="box-example-text">(Autogenerated)</td>
              <td><input type="text" class="form-control box-name-text" id="box-item-{{ i }}-name" name="box-item-{{ i }}-name" value="{{ d['box-item-'~i~'-name'] }}"></td>
            </tr>
            <tr>
              <td>General Name</td>
              <td class="box-example-text">(Ex: Coke Diet)</td>
              <td><input type="text" class="form-control" id="box-item-{{ i }}-general" name="box-item-{{ i }}-general" value="{{ d['box-item-'~i~'-general'] }}"></td>
            </tr>
            <tr>
              <td>Volume</td>
              <td class="box-example-text">(Ex: 12oz)</td>
              <td><input type="text" class="form-control" id="box-item-{{ i }}-volume" name="box-item-{{ i }}-volume" value="{{ d['box-item-'~i~'-volume'] }}"></td>
            </tr>
            <tr>
              <td>Barcode</td>
              <td></td>
              <td><input type="number" min="0" class="form-control barcode-check" id="box-item-{{ i }}-barcode" name="box-item-{{ i }}-barcode" value="{{ d['box-item-'~i~'-barcode'] }}"></td>
            </tr>
          </tbody>
        </table>

      </td>
      <td><input type="number" min="0" class="form-control subitem-quantity" id="box-item-{{ i }}-quantity" name="box-item-{{ i }}-quantity" value="{{ d['box-item-'~i~'-quantity'] }}"></td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<button type="button" class="btn btn-info" id="box-new-subitem">Add New Subitem</button>

<button type="submit" class="btn btn-success">Add Box</button>

</form>

{% endblock %}

{% block onload %}
<script src="{{'chezbetty:static/js/chezbetty-admin-noenter.js'|static_url}}"></script>
{% endblock %}
